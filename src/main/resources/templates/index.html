<!DOCTYPE html>
<html lang="en">
<head>
    <title>우리음식 :: 농가와 소비자를 잇다</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="/images/favicon.ico">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">

    <link rel="stylesheet" href="/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="/css/animate.css">

    <link rel="stylesheet" href="/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="/css/magnific-popup.css">

    <link rel="stylesheet" href="/css/aos.css">

    <link rel="stylesheet" href="/css/ionicons.min.css">

    <link rel="stylesheet" href="/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/css/jquery.timepicker.css">

    <link rel="stylesheet" href="/css/flaticon.css">
    <link rel="stylesheet" href="/css/icomoon.css">
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* 모달의 크기 조정 */
        .modal-dialog {
            position: fixed;
            bottom: 180px; /* 버튼 위로 위치 */
            right: 20px; /* 버튼 오른쪽 끝과 맞추기 */
            margin: 0;
            width: 450px; /* 너비를 1.5배로 증가 */
            height: 600px; /* 높이를 3배로 증가 */
        }

        .modal-content {
            border-radius: 10px 10px 0 0; /* 모서리를 둥글게 */
            height: 100%; /* 모달 내용이 전체 높이를 채우도록 설정 */
        }

        /* 모달 버튼 스타일 */
        .modal-btn-fixed {
            position: fixed;
            bottom: 20px; /* 화면 하단에서 20px 위 */
            right: 20px;  /* 화면 오른쪽에서 20px 왼쪽 */
            z-index: 1000; /* 버튼이 다른 요소들보다 위에 있도록 */
            padding: 15px 30px; /* 버튼 패딩을 키워서 크기 증가 */
            font-size: 1.5rem; /* 폰트 크기 증가 */
        }
    </style>
</head>
<body class="goto-here">

<!--회원가입, 로그인, 로그아웃, 마이페이지-->
<div class="container user-head" th:if="${login}">
    <th:block th:if="${isSeller}">
        <a href="/farm">농가정보</a>
    </th:block>
    <a href="/mypage">마이페이지</a>
    <a href="/logout">로그아웃</a>
</div>
<div class="container user-head" th:unless="${login}">
    <a href="/sign">회원가입</a>
    <a href="/login">로그인</a>
</div>

<!-- 모달 콘텐츠를 포함시킴 -->
<div th:replace="~{chat-modal :: modal}"></div>

<!-- 모달 버튼 -->
<button th:if="${isSeller}" type="button" class="btn btn-primary modal-btn-fixed" data-toggle="modal" data-target="#myModal">
    AI 상품 등록
</button>
<!--검색창-->
<div class="container" style="display: flex; justify-content: space-between; align-items: center">
    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" class="logo-img"></a>
    <form action="/search" method="get" class="search-container" style="height: 100%">
        <input class="search-input" name="search_word" type="text" placeholder="">
        <button class="search-button" type="submit">검색</button>
    </form>
</div>
<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
    <div class="container">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
                aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu">메뉴</span>
        </button>

        <div class="collapse navbar-collapse" id="ftco-nav" style="justify-content: center">
            <ul class="navbar-nav">
                <li class="nav-item"><a href="/" class="nav-link">홈</a></li>
                <li class="nav-item"><a href="/market-price" class="nav-link">시세 조회</a></li>
                <li class="nav-item"><a href="/search/category/1" class="nav-link">못난이 농산물</a></li>
                <li class="nav-item"><a href="/search/category/2" class="nav-link">신품종 작물</a></li>
                <li class="nav-item"><a href="/search/category/3" class="nav-link">농작물</a></li>
                <li class="nav-item"><a href="/search/category/4" class="nav-link">축산물</a></li>
                <li class="nav-item"><a href="/search/category/5" class="nav-link">가공식품</a></li>
                <li class="nav-item"><a href="/farms" class="nav-link">농가 목록</a></li>
                <li class="nav-item cta cta-colored">
                    <a href="/cart" class="nav-link">
                        <span class="icon-shopping_cart"></span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<!-- END nav -->

<!--banner-->
<section id="home-section" class="hero">
    <div class="home-slider owl-carousel">
        <div class="slider-item js-fullheight">
            <div class="overlay"></div>
            <div class="container-fluid p-0">
                <div class="row d-md-flex no-gutters slider-text align-items-center justify-content-center"
                     data-scrollax-parent="true">
                    <img class="one-third order-md-last img-fluid" src="/images/001.jpg" alt="">
                    <div class="one-forth d-flex align-items-center ftco-animate"
                         data-scrollax=" properties: { translateY: '70%' }">
                    </div>
                </div>
            </div>
        </div>

        <div class="slider-item js-fullheight">
            <div class="overlay"></div>
            <div class="container-fluid p-0">
                <div class="row d-flex no-gutters slider-text align-items-center justify-content-center"
                     data-scrollax-parent="true">
                    <img class="one-third order-md-last img-fluid" src="/images/002.jpg" alt="">
                    <div class="one-forth d-flex align-items-center ftco-animate"
                         data-scrollax=" properties: { translateY: '70%' }">
                    </div>
                </div>
            </div>
        </div>
        <div class="slider-item js-fullheight">
            <div class="overlay"></div>
            <div class="container-fluid p-0">
                <div class="row d-flex no-gutters slider-text align-items-center justify-content-center"
                     data-scrollax-parent="true">
                    <img class="one-third order-md-last img-fluid" src="/images/003.jpg" alt="">
                    <div class="one-forth d-flex align-items-center ftco-animate"
                         data-scrollax=" properties: { translateY: '70%' }">
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--product-->
<section class="ftco-section bg-light">
    <div class="container">
        <div class="row justify-content-center mb-3 pb-3">
            <div class="col-md-12 heading-section text-center ftco-animate">
                <h2 class="mb-4">가장 먼저 만나는 신상품!</h2>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex" th:each="product: ${products}">
                <div class="product d-flex flex-column">
                    <a th:href="'/'+${product.id}" class="img-prod">
                        <img class="img-thumbnail" th:src="${product.img}" alt="product img">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a th:href="'/'+${product.id}" th:text="${product.name}"></a></h3>
                        <div class="pricing">
                            <p class="price"><span
                                th:text="${#numbers.formatInteger(product.price, 3, 'COMMA')}+'원'"></span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--product-->
<section class="ftco-section bg-light">
    <div class="container">
        <div class="row justify-content-center mb-3 pb-3">
            <div class="col-md-12 heading-section text-center ftco-animate">
                <h2 class="mb-4">더운 여름, 더 시원하게!</h2>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/91" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/91/75f85277-108e-47ba-8660-2475f2c748dforange-juice.jpg" alt="product image">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/91">[미리네] 미리네 오렌지주스 - 신선한 자연의 맛, 직접 착즙</a></h3>
                        <div class="pricing">
                            <p class="price"><span>5,500원</span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/105" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/105/1ed0ac39-7d82-4f5d-aacf-fedf0e0cadc7dhdl.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/105">[햇빛농가] 햇빛농가의 신선한 주말 오이</a></h3>
                        <div class="pricing">
                            <p class="price">
                                <span>8,900원</span>
                                <!--                                <span class="mr-2 price-dc">$120.00</span>-->
                                <!--                                <span class="price-sale">$80.00</span>-->
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/110" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/110/636d43b9-d3f6-481c-b493-fdc34cc120eezldnlwntm.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/110">[정범농가] 정범농가 여름 시즌 한정 블루베리 키위 스무디</a></h3>
                        <div class="pricing">
                            <p class="price"><span>7,000원</span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/120" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/120/19a30647-e14a-492b-a7fe-658674a21bc6zhdrnrtn.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/120">[미리네] 미리네 콩국수 - 신선하게 직접 간 콩물</a></h3>
                        <div class="pricing">
                            <p class="price"><span>7,500원</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--product-->
<section class="ftco-section bg-light">
    <div class="container">
        <div class="row justify-content-center mb-3 pb-3">
            <div class="col-md-12 heading-section text-center ftco-animate">
                <h2 class="mb-4">여름 몸보신엔 한우·한돈!</h2>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/95" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/95/086104af-f87b-4973-92de-bbc38d874b02001.jpg" alt="product image">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <!--                        <div class="d-flex">-->
                        <!--                            <div class="cat">-->
                        <!--                                <span>별량김수경</span>-->
                        <!--                            </div>-->
                        <!--                        </div>-->
                        <h3><a href="/95">[철수네] 철수네 신선한 돼지고기</a></h3>
                        <div class="pricing">
                            <p class="price"><span>22,000원</span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/99" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/99/c835d771-6ed6-44f5-9f9b-0059d03d4393pork4.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/99">[철수네] 고품질의 한돈 목살 스테이크 - 풍부한 맛과 부드러운 식감의 특별한 경험</a></h3>
                        <div class="pricing">
                            <p class="price">
                                <span>18,000원</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/96" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/96/683e05be-cf38-4c71-bca4-f6ad956d4d9f001.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/96">[철수네] 철수네 40년 전통 한방 족발 - 진한 풍미와 건강함을 담다</a></h3>
                        <div class="pricing">
                            <p class="price"><span>2,7000원</span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/97" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/97/766c30bd-3f14-4e13-87e1-2bc42d27da84pork3.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/97">[철수네] 철수네 맛있고 푸짐한 제육 도시락</a></h3>
                        <div class="pricing">
                            <p class="price"><span>7,900원</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--product-->
<section class="ftco-section bg-light">
    <div class="container">
        <div class="row justify-content-center mb-3 pb-3">
            <div class="col-md-12 heading-section text-center ftco-animate">
                <h2 class="mb-4">강원도 산지 직송</h2>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/103" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/103/41e13cfc-2eab-4776-83de-8ef7004bb5fdl_2021021101001283200109721.jpg" alt="product image">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/103">[햇빛농가] 햇빛농가 강원도산 고구마</a></h3>
                        <div class="pricing">
                            <p class="price"><span>27,000원</span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/106" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/106/fbcf875e-e65b-4db7-9dfb-49178b39ac9atksskanf.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/106">[햇빛농가] 햇빛농가의 신선한 강원도 산나물</a></h3>
                        <div class="pricing">
                            <p class="price">
                                <span>18,000원</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/104" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/104/2b31d78d-3f84-4688-9bcc-4e93c983b2c7yongin-2407636.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/104">[햇빛농가] 햇빛농가의 전통 강원도 햇빛 메주</a></h3>
                        <div class="pricing">
                            <p class="price"><span>18,000원</span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 ftco-animate d-flex">
                <div class="product d-flex flex-column">
                    <a href="/101" class="img-prod">
                        <img class="img-thumbnail" src="https://cdn.we-food.store/product/101/e637da0b-3c09-40ef-b208-b4920d4cecf8potato-1653301.jpg" alt="상품 이미지">
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3">
                        <h3><a href="/101">[햇빛농가] 햇빛농가의 신선하고 질 좋은 감자</a></h3>
                        <div class="pricing">
                            <p class="price"><span>14,000원</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--<section class="ftco-section ftco-choose ftco-no-pb ftco-no-pt">-->
<!--    <div class="container">-->
<!--        <div class="row no-gutters">-->
<!--            <div class="col-lg-4">-->
<!--                <div class="choose-wrap divider-one img p-5 d-flex align-items-end"-->
<!--                     style="background-image: url(/images/choose-1.jpg);">-->

<!--                    <div class="text text-center text-white px-2">-->
<!--                        <span class="subheading">Men's Shoes</span>-->
<!--                        <h2>Men's Collection</h2>-->
<!--                        <p>Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language-->
<!--                            ocean.</p>-->
<!--                        <p><a href="#" class="btn btn-black px-3 py-2">Shop now</a></p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-lg-8">-->
<!--                <div class="row no-gutters choose-wrap divider-two align-items-stretch">-->
<!--                    <div class="col-md-12">-->
<!--                        <div class="choose-wrap full-wrap img align-self-stretch d-flex align-item-center justify-content-end"-->
<!--                             style="background-image: url(/images/choose-2.jpg);">-->
<!--                            <div class="col-md-7 d-flex align-items-center">-->
<!--                                <div class="text text-white px-5">-->
<!--                                    <span class="subheading">Women's Shoes</span>-->
<!--                                    <h2>Women's Collection</h2>-->
<!--                                    <p>Separated they live in Bookmarksgrove right at the coast of the Semantics, a-->
<!--                                        large language ocean.</p>-->
<!--                                    <p><a href="#" class="btn btn-black px-3 py-2">Shop now</a></p>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="col-md-12">-->
<!--                        <div class="row no-gutters">-->
<!--                            <div class="col-md-6">-->
<!--                                <div class="choose-wrap wrap img align-self-stretch bg-light d-flex align-items-center">-->
<!--                                    <div class="text text-center px-5">-->
<!--                                        <span class="subheading">Summer Sale</span>-->
<!--                                        <h2>Extra 50% Off</h2>-->
<!--                                        <p>Separated they live in Bookmarksgrove right at the coast of the Semantics, a-->
<!--                                            large language ocean.</p>-->
<!--                                        <p><a href="#" class="btn btn-black px-3 py-2">Shop now</a></p>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="col-md-6">-->
<!--                                <div class="choose-wrap wrap img align-self-stretch d-flex align-items-center"-->
<!--                                     style="background-image: url(/images/choose-3.jpg);">-->
<!--                                    <div class="text text-center text-white px-5">-->
<!--                                        <span class="subheading">Shoes</span>-->
<!--                                        <h2>Best Sellers</h2>-->
<!--                                        <p>Separated they live in Bookmarksgrove right at the coast of the Semantics, a-->
<!--                                            large language ocean.</p>-->
<!--                                        <p><a href="#" class="btn btn-black px-3 py-2">Shop now</a></p>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</section>-->

<footer class="ftco-footer ftco-section">
    <div class="container">
        <div class="row">
            <div class="mouse">
                <a href="#" class="mouse-icon">
                    <div class="mouse-wheel"><span class="ion-ios-arrow-up"></span></div>
                </a>
            </div>
        </div>
        <div class="row mb-5">
            <div class="col-md">
                <div class="ftco-footer-widget mb-4">
                    <h2 class="ftco-heading-2">전국로컬푸드 우리음식</h2>
                    <ul class="ftco-footer-social list-unstyled float-md-left float-lft mt-5">
                        <li class="ftco-animate"><a href="#"><span class="icon-twitter"></span></a></li>
                        <li class="ftco-animate"><a href="#"><span class="icon-facebook"></span></a></li>
                        <li class="ftco-animate"><a href="#"><span class="icon-instagram"></span></a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md">
                <div class="ftco-footer-widget mb-4 ml-md-5">
                    <ul class="list-unstyled">
                        <li><a href="#" class="py-2 d-block">우리음식 소개</a></li>
                        <li><a href="#" class="py-2 d-block">이용안내</a></li>
                        <li><a href="#" class="py-2 d-block">개인정보처리방침</a></li>
                        <li><a href="#" class="py-2 d-block">이용약관</a></li>
                        <li><a href="#" class="py-2 d-block">고객센터</a></li>
                    </ul>
                </div>
            </div>
            <!--            <div class="col-md-4">-->
            <!--                <div class="ftco-footer-widget mb-4">-->
            <!--                    <h2 class="ftco-heading-2">Help</h2>-->
            <!--                    <div class="d-flex">-->
            <!--                        <ul class="list-unstyled mr-l-5 pr-l-3 mr-4">-->
            <!--                            <li><a href="#" class="py-2 d-block">Shipping Information</a></li>-->
            <!--                            <li><a href="#" class="py-2 d-block">Returns &amp; Exchange</a></li>-->
            <!--                            <li><a href="#" class="py-2 d-block">Terms &amp; Conditions</a></li>-->
            <!--                            <li><a href="#" class="py-2 d-block">Privacy Policy</a></li>-->
            <!--                        </ul>-->
            <!--                        <ul class="list-unstyled">-->
            <!--                            <li><a href="#" class="py-2 d-block">FAQs</a></li>-->
            <!--                            <li><a href="#" class="py-2 d-block">Contact</a></li>-->
            <!--                        </ul>-->
            <!--                    </div>-->
            <!--                </div>-->
            <!--            </div>-->
            <div class="col-md">
                <div class="ftco-footer-widget mb-4">
                    <div class="block-23 mb-3">
                        <ul>
                            <li><span class="icon icon-map-marker"></span>
                                <span class="text">춘천시 평화로 25 (근화동 199)</span>
                            </li>
                            <li><a href="#"><span class="icon icon-phone"></span><span
                                    class="text">+82 033) 257-7800</span></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">

                <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    Copyright &copy;<script>document.write(new Date().getFullYear());</script>
                    All rights reserved | This template is made with <i class="icon-heart color-danger"
                                                                        aria-hidden="true"></i> by <a
                            href="https://colorlib.com" target="_blank">Colorlib</a>
                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </p>
            </div>
        </div>
    </div>
</footer>


<!-- loader -->
<div id="ftco-loader" class="show fullscreen">
    <svg class="circular" width="48px" height="48px">
        <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/>
        <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                stroke="#F96D00"/>
    </svg>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/jquery-migrate-3.0.1.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.easing.1.3.js"></script>
<script src="/js/jquery.waypoints.min.js"></script>
<script src="/js/jquery.stellar.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/aos.js"></script>
<script src="/js/jquery.animateNumber.min.js"></script>
<script src="/js/bootstrap-datepicker.js"></script>
<script src="/js/scrollax.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
<script src="/js/google-map.js"></script>
<script src="/js/main.js"></script>
<script>
    let dataLet;
    let name;
    let detail;
    let tags;
    let selectedValue;
    let price;
    let productId;
    function updateModalContent(url) {
        $.ajax({
            url: url,
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                dataLet =data;
                // 서버에서 받은 데이터를 사용해 모달의 내용을 업데이트
                $('#modalContent').html(`
                <h6>농장 정보</h6>
                <p>${data.farm.name}</p>
                <h6>질문 리스트</h6>
                <ul>
                    ${data.quest.map((q, index) => `
                        <li>
                            ${q}
                            <br>
                            <input type="text" id="input${index}" placeholder="답변을 입력하세요"/>
                        </li>
                    `).join('')}
                </ul>
                <div class="modal-footer">
                    <button class="btn btn-primary" style="height: 40px; font-size: 18px;" id="submitBtn">제출</button>
                </div>
            `);

                // 모달을 표시
                $('#myModal').modal('show');

                // 제출 버튼 클릭 이벤트 핸들러 등록
                $('#submitBtn').click(function() {
                    console.log("test")
                    submitFormData(data.quest.length);
                });

            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.error("Error loading modal content: " + textStatus);
            }
        });
    }
    function closeComeBack(){
        alert("취소되었습니다.")
        window.location.href = "/";
    }
    function submitFormData2(name, detail, tags, farmId, selectedValue, price) {
        const data = {
            title: name,
            detail: detail,
            tagName: tags,
            farmId: farmId,
            categoryId  : selectedValue,
            price: price
        };

        $.ajax({
            url: '/create-product',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(data),
            success: function(response) {
                console.log('Product created successfully!', response);
                $('#modalContent').html(
                    `<h6>상품이 정상적으로 등록되었습니다.</h6>
     <br>
     <h6>대표 사진을 등록해 주세요.</h6>
     <br>
     <form id="thumbnailUploadForm" enctype="multipart/form-data">
        <input type="file" id="thumbnailFile" name="files" accept="image/*" required />
        <button type="button" class="btn btn-primary" style="height: 40px; font-size: 18px;" id="uploadThumbnailButton">썸네일 업로드</button>
     </form>
    `
                );
                productId=response.productId;
                $('#uploadThumbnailButton').click(function() {
                    console.log("클릭");
                    const fileInput = document.getElementById('thumbnailFile');
                    const file = fileInput.files[0];

                    if (!file) {
                        alert("파일을 선택해 주세요.");
                        return;
                    }
                    console.log("파일선택완료")
                    const formData = new FormData();
                    formData.append("id", productId);  // productId는 서버에서 생성된 상품의 ID
                    formData.append("files", file);    // 선택한 파일을 폼 데이터에 추가

                    $.ajax({
                        url: '/product/thumbnail',
                        type: 'POST',
                        data: formData,
                        processData: false, // 필수: jQuery가 데이터를 문자열로 처리하지 않도록 설정
                        contentType: false, // 필수: jQuery가 Content-Type 헤더를 설정하지 않도록 설정
                        success: function (response) {
                            alert('썸네일이 성공적으로 업로드되었습니다.');
                            $('#modalContent').html(
                                `<h6>대표 사진이 정상적으로 등록되었습니다.</h6>
                                 <br>
                                 <h6>마지막으로 상품 소개 사진들을 등록해 주세요. (최대 5개)</h6>
                                 <br>
                                 <form id="additionalImagesForm" enctype="multipart/form-data">
                                    <input type="file" id="additionalImages" name="additionalFiles" accept="image/*" multiple required />
                                    <button type="button" class="btn btn-primary" id="uploadAdditionalImagesButton">상품 사진 업로드</button>
                                 </form>
                                `
                            );
                            $('#uploadAdditionalImagesButton').click(function() {
                                const filesInput = document.getElementById('additionalImages');
                                const files = filesInput.files;

                                if (files.length === 0) {
                                    alert("파일을 선택해 주세요.");
                                    return;
                                }

                                if (files.length > 5) {
                                    alert("최대 5개의 파일만 업로드 할 수 있습니다.");
                                    return;
                                }

                                const formData = new FormData();
                                formData.append("id", productId);  // productId는 이전에 생성된 상품의 ID를 사용

                                // 선택된 각 파일을 폼 데이터에 추가
                                for (let i = 0; i < files.length; i++) {
                                    formData.append("files", files[i]);
                                }

                                $.ajax({
                                    url: '/productImage',
                                    type: 'POST',
                                    data: formData,
                                    processData: false, // 필수: jQuery가 데이터를 문자열로 처리하지 않도록 설정
                                    contentType: false, // 필수: jQuery가 Content-Type 헤더를 설정하지 않도록 설정
                                    success: function(response) {
                                        alert('상품 소개 사진들이 성공적으로 업로드 되었습니다.');
                                        // Alert에서 OK를 누르면 인덱스 페이지로 리다이렉트
                                        window.location.href = "/";
                                    },
                                    error: function(xhr, status, error) {
                                        console.error('사진들 업로드 실패:', error);
                                        alert('사진들 업로드에 실패했습니다. 다시 시도해 주세요.');
                                    }
                                });
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error('썸네일 업로드 실패:', error);
                            alert('썸네일 업로드에 실패했습니다. 다시 시도해 주세요.');
                        }
                    });
                });
                // 성공 시 추가 작업 (예: 사용자에게 알림 표시)
            },
            error: function(xhr, status, error) {
                console.error('Failed to create product:', error);
                // 실패 시 추가 작업 (예: 사용자에게 오류 메시지 표시)
            }
        });
    }
    function submitFormData(questionCount) {
        let formData = {
            model: "gpt-4o",
            isProduct: true,
            input: [],
        };

        // questionCount만큼 input 값을 수집
        for (let i = 0; i < questionCount; i++) {
            let inputVal = $(`#input${i}`).val();
            console.log(inputVal);
            formData.input.push(inputVal);
        }
        formData.input.push(dataLet.farm.name);
        // 데이터 인코딩: 배열을 문자열로 변환 (콤마로 구분)
        let encodedData = $.param({
            model: formData.model,
            isProduct: formData.isProduct,
            input: formData.input.join(','), // 배열을 문자열로 변환
        });

        $.ajax({
            url: '/api/gpt/chat',
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            data: encodedData, // URL 쿼리 문자열 형식으로 전송
            success: function (response) {
                console.log('성공:', response);
                name = response.data?.name || response.name;
                detail = response.data?.detail || response.detail;
                tags = response.data?.tags || response.tags || response.tag || response.data.tag;
                $('#modalContent').html(
                    `<h6>상품명: </h6> <h6>${name}</h6>
     <br>
     <h6>상품 소개: </h6> <h6>${detail}</h6>
     <br>
     <h6>태그 종류: </h6> <h6>${tags}</h6>
     <br>
     <h6>마음에 드시면 아래 카테고리를 선택 후 마음에 들어요 버튼을 눌러주세요.</h6>
     <br>
     <select id="categorySelect">
        <option value="" disabled selected>카테고리를 선택하세요.</option>
     </select>
     <br>
     <h6>원하시는 상품의 가격을 적어주세요.</h6>
     <input type="text" id="price" placeholder="답변을 입력하세요"/>

     <div class="modal-footer">
         <button class="btn btn-primary" style="height: 40px; font-size: 18px;" id="submitBtn2">좋아요</button>
         <button class="btn btn-secondary" style="height: 40px; font-size: 18px;" id="close2">취소</button>
     </div>`
                );
                document.getElementById('price').addEventListener('input', function(event) {
                    price = event.target.value; // 사용자가 입력한 값을 price 변수에 저장
                    console.log('Price updated:', price); // 업데이트된 price 값을 콘솔에 출력
                });
                console.log(price); // 콘솔에 입력된 값을 출력

                const options = Object.entries(dataLet.categories).map(([key, value]) =>
                    `<option value="${key}">${value}</option>`
                ).join(''); // 배열을 문자열로 변환
                $('#categorySelect').append(options);
                $('#categorySelect').on('change', function() {
                    selectedValue = $(this).val(); // 선택된 값
                    console.log('Selected Value:', selectedValue);
                });
                $('#close2').click(function (){
                    closeComeBack();
                });
                $('#submitBtn2').click(function() {
                    submitFormData2(name, detail,tags, dataLet.farm.id,selectedValue,price);
                });

            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#modalContent').html("예상치 못한 문제 발생 다시 시도해 주세요.");
            }
        });
    }
    document.getElementById('oneTimeButton').addEventListener('click', function() {
        this.style.display = 'none';
    });
</script>
</body>
</html>